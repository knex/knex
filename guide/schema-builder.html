<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Schema Builder | Knex.js</title>
    <meta name="description" content="Beta knex.js documentation.">
    <link rel="stylesheet" href="/assets/style.a21b8e16.css">
    <link rel="modulepreload" href="/assets/chunks/AlgoliaSearchBox.a88cc1e3.js">
    <link rel="modulepreload" href="/assets/chunks/AlgoliaSearchBox.639416b3.js">
    <link rel="modulepreload" href="/assets/app.36cb52e5.js">
    <link rel="modulepreload" href="/assets/guide_schema-builder.md.8594d7f3.lean.js">
    
    <link rel="icon" type="image/png" href="/knex-logo.png">
  <meta name="twitter:title" content="Schema Builder | Knex.js">
  <meta property="og:title" content="Schema Builder | Knex.js">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-675d8756><div class="sidebar-button" data-v-675d8756><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/" aria-label="Knex.js, back to home" data-v-675d8756 data-v-cc01ef16><img class="logo" src="/knex-logo.png" alt="Logo" data-v-cc01ef16> Knex.js</a><div class="flex-grow" data-v-675d8756></div><div class="nav" data-v-675d8756><nav class="nav-links" data-v-675d8756 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item active" href="/guide/" data-v-b8818f8c>Guide <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/faq/" data-v-b8818f8c>F.A.Q. <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/changelog.html" data-v-b8818f8c>Changelog <!----></a></div></div><!--]--><!----><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/knex/knex" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav></div><!--[--><!--[--><select class="sql-dropdown item nav-link"><option value="mysql" selected>MySQL / MariaDB</option><option value="mysql2">MySQL2</option><option value="postgres">PostgreSQL</option><option value="pgnative">PG Native</option><option value="cockroachdb">CockroachDB</option><option value="redshift">Amazon Redshift</option><option value="sqlite3">SQLite3</option><option value="oracledb">OracleDB</option><option value="mssql">MSSQL</option></select><div class="algolia-search-box" id="docsearch"></div><a class="toggle-dark" tabindex="0" role="button" data-v-2a5e0da6><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" width="32" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256" data-v-2a5e0da6><circle cx="128" cy="128" r="60" fill="currentColor" opacity=".2" data-v-2a5e0da6></circle><path fill="currentColor" d="M128 60a68 68 0 1 0 68 68a68.1 68.1 0 0 0-68-68Zm0 120a52 52 0 1 1 52-52a52 52 0 0 1-52 52Zm-8-144V16a8 8 0 0 1 16 0v20a8 8 0 0 1-16 0ZM43.1 54.5a8.1 8.1 0 1 1 11.4-11.4l14.1 14.2a8 8 0 0 1 0 11.3a8.1 8.1 0 0 1-11.3 0ZM36 136H16a8 8 0 0 1 0-16h20a8 8 0 0 1 0 16Zm32.6 51.4a8 8 0 0 1 0 11.3l-14.1 14.2a8.3 8.3 0 0 1-5.7 2.3a8.5 8.5 0 0 1-5.7-2.3a8.1 8.1 0 0 1 0-11.4l14.2-14.1a8 8 0 0 1 11.3 0ZM136 220v20a8 8 0 0 1-16 0v-20a8 8 0 0 1 16 0Zm76.9-18.5a8.1 8.1 0 0 1 0 11.4a8.5 8.5 0 0 1-5.7 2.3a8.3 8.3 0 0 1-5.7-2.3l-14.1-14.2a8 8 0 0 1 11.3-11.3ZM248 128a8 8 0 0 1-8 8h-20a8 8 0 0 1 0-16h20a8 8 0 0 1 8 8Zm-60.6-59.4a8 8 0 0 1 0-11.3l14.1-14.2a8.1 8.1 0 0 1 11.4 11.4l-14.2 14.1a8.1 8.1 0 0 1-11.3 0Z" data-v-2a5e0da6></path></svg></a><!--]--><!--]--></header><aside class="sidebar" data-v-83e92a68><nav class="nav-links nav" data-v-83e92a68 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item active" href="/guide/" data-v-b8818f8c>Guide <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/faq/" data-v-b8818f8c>F.A.Q. <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/changelog.html" data-v-b8818f8c>Changelog <!----></a></div></div><!--]--><!----><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/knex/knex" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav><!--[--><!--]--><ul class="sidebar-links" data-v-83e92a68><!--[--><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/">Installation</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/query-builder">Query Builder</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/transactions">Transactions</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item active" href="/guide/schema-builder">Schema Builder</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#essentials">Essentials</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#withschema">withSchema</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#createtable">createTable</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#createtablelike">createTableLike</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#droptable">dropTable</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#droptableifexists">dropTableIfExists</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#renametable">renameTable</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#hastable">hasTable</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#hascolumn">hasColumn</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#table">table</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#altertable">alterTable</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#createview">createView</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#createvieworreplace">createViewOrReplace</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#creatematerializedview">createMaterializedView</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#refreshmaterializedview">refreshMaterializedView</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#dropview">dropView</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#dropviewifexists">dropViewIfExists</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#dropmaterializedview">dropMaterializedView</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#dropmaterializedviewifexists">dropMaterializedViewIfExists</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#renameview">renameView</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#alterview">alterView</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#generateddlcommands">generateDdlCommands</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#raw">raw</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#querycontext">queryContext</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#dropschema">dropSchema</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#dropschemaifexists">dropSchemaIfExists</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#schema-building">Schema Building</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#dropcolumn">dropColumn</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#dropcolumns">dropColumns</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#renamecolumn">renameColumn</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#increments">increments</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#integer">integer</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#biginteger">bigInteger</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#tinyint">tinyint</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#smallint">smallint</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#mediumint">mediumint</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#bigint">bigint</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#text">text</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#string">string</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#float">float</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#double">double</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#decimal">decimal</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#boolean">boolean</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#date">date</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#datetime">datetime</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#time">time</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#timestamp">timestamp</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#timestamps">timestamps</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#droptimestamps">dropTimestamps</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#binary">binary</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#enum-enu">enum / enu</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#json">json</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#jsonb">jsonb</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#uuid">uuid</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#geometry">geometry</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#geography">geography</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#point">point</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#comment">comment</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#engine">engine</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#charset">charset</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#collate">collate</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#inherits">inherits</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#specifictype">specificType</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#index">index</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#dropindex">dropIndex</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#setnullable">setNullable</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#dropnullable">dropNullable</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#primary">primary</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#unique">unique</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#foreign">foreign</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#dropforeign">dropForeign</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#dropunique">dropUnique</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#dropprimary">dropPrimary</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#querycontext-1">queryContext</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#chainable-methods">Chainable Methods</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#alter">alter</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#index-1">index</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#primary-1">primary</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#unique-1">unique</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#references">references</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#intable">inTable</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#ondelete">onDelete</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#onupdate">onUpdate</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#defaultto">defaultTo</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#unsigned">unsigned</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#notnullable">notNullable</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#nullable">nullable</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#first">first</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#after">after</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#comment-1">comment</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#collate-1">collate</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#view">View</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#columns">columns</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#as">as</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#checkoption">checkOption</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#localcheckoption">localCheckOption</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#cascadedcheckoption">cascadedCheckOption</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#checks">Checks</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#check">check</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#checkpositive">checkPositive</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#checknegative">checkNegative</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#checkin">checkIn</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#checknotin">checkNotIn</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#checkbetween">checkBetween</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#checklength">checkLength</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#checkregex">checkRegex</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#dropchecks">dropChecks</a><!----></li></ul></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/raw">Raw</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/ref">Ref</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/utility">Utility</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/interfaces">Interfaces</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/migrations">Migrations</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/extending">Extending</a><!----></li><!--]--></ul><!--[--><!--]--></aside><div class="sidebar-mask"></div><main class="page" data-v-7eddb2c4><div class="container" data-v-7eddb2c4><!--[--><!--]--><div style="position:relative;" class="content" data-v-7eddb2c4><div><h1 id="schema-builder" tabindex="-1">Schema Builder <a class="header-anchor" href="#schema-builder" aria-hidden="true">#</a></h1><p>The <code>knex.schema</code> is a <strong>getter function</strong>, which returns a stateful object containing the query. Therefore be sure to obtain a new instance of the <code>knex.schema</code> for every query. These methods return <a href="/guide/interfaces.html#promises">promises</a>.</p><h2 id="essentials" tabindex="-1">Essentials <a class="header-anchor" href="#essentials" aria-hidden="true">#</a></h2><h3 id="withschema" tabindex="-1">withSchema <a class="header-anchor" href="#withschema" aria-hidden="true">#</a></h3><p><strong>knex.schema.withSchema([schemaName])</strong></p><p>Specifies the schema to be used when using the schema-building commands.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">withSchema</span><span class="token punctuation">(</span><span class="token string">&#39;public&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">increments</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="createtable" tabindex="-1">createTable <a class="header-anchor" href="#createtable" aria-hidden="true">#</a></h3><p><strong>knex.schema.createTable(tableName, callback)</strong></p><p>Creates a new table on the database, with a callback function to modify the table&#39;s structure, using the schema-building commands.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">increments</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  table<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  table<span class="token punctuation">.</span><span class="token function">timestamps</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="createtablelike" tabindex="-1">createTableLike <a class="header-anchor" href="#createtablelike" aria-hidden="true">#</a></h3><p><strong>knex.schema.createTableLike(tableName, tableNameToCopy, [callback])</strong></p><p>Creates a new table on the database based on another table. Copy only the structure : columns, keys and indexes (expected on SQL Server which only copy columns) and not the data. Callback function can be specified to add columns in the duplicated table.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createTableLike</span><span class="token punctuation">(</span><span class="token string">&#39;new_users&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;users&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// &quot;new_users&quot; table contains columns</span>
<span class="token comment">// of users and two new columns &#39;age&#39; and &#39;last_name&#39;.</span>
knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createTableLike</span><span class="token punctuation">(</span><span class="token string">&#39;new_users&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;users&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">integer</span><span class="token punctuation">(</span><span class="token string">&#39;age&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  table<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;last_name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="droptable" tabindex="-1">dropTable <a class="header-anchor" href="#droptable" aria-hidden="true">#</a></h3><p><strong>knex.schema.dropTable(tableName)</strong></p><p>Drops a table, specified by tableName.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">dropTable</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="droptableifexists" tabindex="-1">dropTableIfExists <a class="header-anchor" href="#droptableifexists" aria-hidden="true">#</a></h3><p><strong>knex.schema.dropTableIfExists(tableName)</strong></p><p>Drops a table conditionally if the table exists, specified by tableName.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">dropTableIfExists</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="renametable" tabindex="-1">renameTable <a class="header-anchor" href="#renametable" aria-hidden="true">#</a></h3><p><strong>knex.schema.renameTable(from, to)</strong></p><p>Renames a table from a current tableName to another.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">renameTable</span><span class="token punctuation">(</span><span class="token string">&#39;old_users&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;users&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="hastable" tabindex="-1">hasTable <a class="header-anchor" href="#hastable" aria-hidden="true">#</a></h3><p><strong>knex.schema.hasTable(tableName)</strong></p><p>Checks for a table&#39;s existence by tableName, resolving with a boolean to signal if the table exists.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">hasTable</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">exists</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>exists<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">t</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      t<span class="token punctuation">.</span><span class="token function">increments</span><span class="token punctuation">(</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">primary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      t<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;first_name&#39;</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      t<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;last_name&#39;</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      t<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">&#39;bio&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="hascolumn" tabindex="-1">hasColumn <a class="header-anchor" href="#hascolumn" aria-hidden="true">#</a></h3><p><strong>knex.schema.hasColumn(tableName, columnName)</strong></p><p>Checks if a column exists in the current table, resolves the promise with a boolean, true if the column exists, false otherwise.</p><h3 id="table" tabindex="-1">table <a class="header-anchor" href="#table" aria-hidden="true">#</a></h3><p><strong>knex.schema.table(tableName, callback)</strong></p><p>Chooses a database table, and then modifies the table, using the Schema Building functions inside of the callback.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">table</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">dropColumn</span><span class="token punctuation">(</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  table<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;first_name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  table<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;last_name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="altertable" tabindex="-1">alterTable <a class="header-anchor" href="#altertable" aria-hidden="true">#</a></h3><p><strong>knex.schema.alterTable(tableName, callback)</strong></p><p>Chooses a database table, and then modifies the table, using the Schema Building functions inside of the callback.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">alterTable</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">dropColumn</span><span class="token punctuation">(</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  table<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;first_name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  table<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;last_name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="createview" tabindex="-1">createView <a class="header-anchor" href="#createview" aria-hidden="true">#</a></h3><p><strong>knex.schema.createView(tableName, callback)</strong></p><p>Creates a new view on the database, with a callback function to modify the view&#39;s structure, using the schema-building commands.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createView</span><span class="token punctuation">(</span><span class="token string">&#39;users_view&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">view</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  view<span class="token punctuation">.</span><span class="token function">columns</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;first_name&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  view<span class="token punctuation">.</span><span class="token function">as</span><span class="token punctuation">(</span><span class="token function">knex</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&#39;first_name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">&#39;age&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;&gt;&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;18&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="createvieworreplace" tabindex="-1">createViewOrReplace <a class="header-anchor" href="#createvieworreplace" aria-hidden="true">#</a></h3><p><strong>knex.schema.createViewOrReplace(tableName, callback)</strong></p><p>Creates a new view or replace it on the database, with a callback function to modify the view&#39;s structure, using the schema-building commands. You need to specify at least the same columns in same order (you can add extra columns). In SQLite, this function generate drop/create view queries (view columns can be different).</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createViewOrReplace</span><span class="token punctuation">(</span><span class="token string">&#39;users_view&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">view</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  view<span class="token punctuation">.</span><span class="token function">columns</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;first_name&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  view<span class="token punctuation">.</span><span class="token function">as</span><span class="token punctuation">(</span><span class="token function">knex</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&#39;first_name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">&#39;age&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;&gt;&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;18&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="creatematerializedview" tabindex="-1">createMaterializedView <a class="header-anchor" href="#creatematerializedview" aria-hidden="true">#</a></h3><p><strong>knex.schema.createMaterializedView(viewName, callback)</strong></p><p>Creates a new materialized view on the database, with a callback function to modify the view&#39;s structure, using the schema-building commands. Only on PostgreSQL, CockroachDb, Redshift and Oracle.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createMaterializedView</span><span class="token punctuation">(</span><span class="token string">&#39;users_view&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">view</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  view<span class="token punctuation">.</span><span class="token function">columns</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;first_name&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  view<span class="token punctuation">.</span><span class="token function">as</span><span class="token punctuation">(</span><span class="token function">knex</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&#39;first_name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">&#39;age&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;&gt;&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;18&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="refreshmaterializedview" tabindex="-1">refreshMaterializedView <a class="header-anchor" href="#refreshmaterializedview" aria-hidden="true">#</a></h3><p><strong>knex.schema.refreshMaterializedView(viewName)</strong></p><p>Refresh materialized view on the database. Only on PostgreSQL, CockroachDb, Redshift and Oracle.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">refreshMaterializedView</span><span class="token punctuation">(</span><span class="token string">&#39;users_view&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="dropview" tabindex="-1">dropView <a class="header-anchor" href="#dropview" aria-hidden="true">#</a></h3><p><strong>knex.schema.dropView(viewName)</strong></p><p>Drop view on the database.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">dropView</span><span class="token punctuation">(</span><span class="token string">&#39;users_view&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="dropviewifexists" tabindex="-1">dropViewIfExists <a class="header-anchor" href="#dropviewifexists" aria-hidden="true">#</a></h3><p><strong>knex.schema.dropViewIfExists(viewName)</strong></p><p>Drop view on the database if exists.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">dropViewIfExists</span><span class="token punctuation">(</span><span class="token string">&#39;users_view&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="dropmaterializedview" tabindex="-1">dropMaterializedView <a class="header-anchor" href="#dropmaterializedview" aria-hidden="true">#</a></h3><p><strong>knex.schema.dropMaterializedView(viewName)</strong></p><p>Drop materialized view on the database. Only on PostgreSQL, CockroachDb, Redshift and Oracle.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">dropMaterializedView</span><span class="token punctuation">(</span><span class="token string">&#39;users_view&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="dropmaterializedviewifexists" tabindex="-1">dropMaterializedViewIfExists <a class="header-anchor" href="#dropmaterializedviewifexists" aria-hidden="true">#</a></h3><p><strong>knex.schema.dropMaterializedViewIfExists(viewName)</strong></p><p>Drop materialized view on the database if exists. Only on PostgreSQL, CockroachDb, Redshift and Oracle.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">dropMaterializedViewIfExists</span><span class="token punctuation">(</span><span class="token string">&#39;users_view&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="renameview" tabindex="-1">renameView <a class="header-anchor" href="#renameview" aria-hidden="true">#</a></h3><p><strong>knex.schema.renameView(viewName)</strong></p><p>Rename a existing view in the database. Not supported by Oracle and SQLite.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">renameView</span><span class="token punctuation">(</span><span class="token string">&#39;users_view&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="alterview" tabindex="-1">alterView <a class="header-anchor" href="#alterview" aria-hidden="true">#</a></h3><p><strong>knex.schema.alterView(viewName)</strong></p><p>Alter view to rename columns or change default values. Only available on PostgreSQL, MSSQL and Redshift.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">alterView</span><span class="token punctuation">(</span><span class="token string">&#39;view_test&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">view</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  view<span class="token punctuation">.</span><span class="token function">column</span><span class="token punctuation">(</span><span class="token string">&#39;first_name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">rename</span><span class="token punctuation">(</span><span class="token string">&#39;name_user&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  view<span class="token punctuation">.</span><span class="token function">column</span><span class="token punctuation">(</span><span class="token string">&#39;bio&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">defaultTo</span><span class="token punctuation">(</span><span class="token string">&#39;empty&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="generateddlcommands" tabindex="-1">generateDdlCommands <a class="header-anchor" href="#generateddlcommands" aria-hidden="true">#</a></h3><p><strong>knex.schema.generateDdlCommands()</strong></p><p>Generates complete SQL commands for applying described schema changes, without executing anything. Useful when knex is being used purely as a query builder. Generally produces same result as .toSQL(), with a notable exception with SQLite, which relies on asynchronous calls to the database for building part of its schema modification statements</p><div class="language-js"><pre><code><span class="token keyword">const</span> ddlCommands <span class="token operator">=</span> knex<span class="token punctuation">.</span>schema
  <span class="token punctuation">.</span><span class="token function">alterTable</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    table
      <span class="token punctuation">.</span><span class="token function">foreign</span><span class="token punctuation">(</span><span class="token string">&#39;companyId&#39;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">references</span><span class="token punctuation">(</span><span class="token string">&#39;company.companyId&#39;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">withKeyName</span><span class="token punctuation">(</span><span class="token string">&#39;fk_fkey_company&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">generateDdlCommands</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="raw" tabindex="-1">raw <a class="header-anchor" href="#raw" aria-hidden="true">#</a></h3><p><strong>knex.schema.raw(statement)</strong></p><p>Run an arbitrary sql query in the schema builder chain.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">raw</span><span class="token punctuation">(</span><span class="token string">&quot;SET sql_mode=&#39;TRADITIONAL&#39;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">table</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">dropColumn</span><span class="token punctuation">(</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  table<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;first_name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  table<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;last_name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="querycontext" tabindex="-1">queryContext <a class="header-anchor" href="#querycontext" aria-hidden="true">#</a></h3><p><strong>knex.schema.queryContext(context)</strong></p><p>Allows configuring a context to be passed to the <a href="/guide/#wrapidentifier">wrapIdentifier</a> hook. The context can be any kind of value and will be passed to <code>wrapIdentifier</code> without modification.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">queryContext</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token string">&#39;bar&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">table</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;first_name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  table<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;last_name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The context configured will be passed to <code>wrapIdentifier</code> for each identifier that needs to be formatted, including the table and column names. However, a different context can be set for the column names via <a href="/guide/query-builder.html#querycontext">table.queryContext</a>.</p><p>Calling <code>queryContext</code> with no arguments will return any context configured for the schema builder instance.</p><h3 id="dropschema" tabindex="-1">dropSchema <a class="header-anchor" href="#dropschema" aria-hidden="true">#</a></h3><p><strong>knex.schema.dropSchema(schemaName, [cascade])</strong></p><p>Drop a schema, specified by the schema&#39;s name, with optional cascade option (default to false). Only supported by PostgreSQL.</p><div class="language-js"><pre><code><span class="token comment">//drop schema &#39;public&#39;</span>
knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">dropSchema</span><span class="token punctuation">(</span><span class="token string">&#39;public&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//drop schema &#39;public&#39; cascade</span>
knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">dropSchema</span><span class="token punctuation">(</span><span class="token string">&#39;public&#39;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="dropschemaifexists" tabindex="-1">dropSchemaIfExists <a class="header-anchor" href="#dropschemaifexists" aria-hidden="true">#</a></h3><p><strong>knex.schema.dropSchemaIfExists(schemaName, [cascade])</strong></p><p>Drop a schema conditionally if the schema exists, specified by the schema&#39;s name, with optional cascade option (default to false). Only supported by PostgreSQL.</p><div class="language-js"><pre><code><span class="token comment">//drop schema if exists &#39;public&#39;</span>
knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">dropSchemaIfExists</span><span class="token punctuation">(</span><span class="token string">&#39;public&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//drop schema if exists &#39;public&#39; cascade</span>
knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">dropSchemaIfExists</span><span class="token punctuation">(</span><span class="token string">&#39;public&#39;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="schema-building" tabindex="-1">Schema Building <a class="header-anchor" href="#schema-building" aria-hidden="true">#</a></h2><h3 id="dropcolumn" tabindex="-1">dropColumn <a class="header-anchor" href="#dropcolumn" aria-hidden="true">#</a></h3><p><strong>table.dropColumn(name)</strong></p><p>Drops a column, specified by the column&#39;s name</p><h3 id="dropcolumns" tabindex="-1">dropColumns <a class="header-anchor" href="#dropcolumns" aria-hidden="true">#</a></h3><p><strong>table.dropColumns(columns)</strong></p><p>Drops multiple columns, taking a variable number of column names.</p><h3 id="renamecolumn" tabindex="-1">renameColumn <a class="header-anchor" href="#renamecolumn" aria-hidden="true">#</a></h3><p><strong>table.renameColumn(from, to)</strong></p><p>Renames a column from one name to another.</p><h3 id="increments" tabindex="-1">increments <a class="header-anchor" href="#increments" aria-hidden="true">#</a></h3><p><strong>table.increments(name, options={[primaryKey: boolean = true])</strong></p><p>Adds an auto incrementing column. In PostgreSQL this is a serial; in Amazon Redshift an integer identity(1,1). This will be used as the primary key for the table if the column isn&#39;t in another primary key. Also available is a bigIncrements if you wish to add a bigint incrementing number (in PostgreSQL bigserial). Note that a primary key is created by default if the column isn&#39;t in primary key (with primary function), but you can override this behaviour by passing the <code>primaryKey</code> option. If you use this function with primary function, the column is added to the composite primary key. With SQLite, autoincrement column need to be a primary key, so if primary function is used, primary keys are transformed in unique index. MySQL don&#39;t support autoincrement column without primary key, so multiple queries are generated to create int column, add increments column to composite primary key then modify the column to autoincrement column.</p><div class="language-js"><pre><code><span class="token comment">// create table &#39;users&#39;</span>
<span class="token comment">// with a primary key using &#39;increments()&#39;</span>
knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">increments</span><span class="token punctuation">(</span><span class="token string">&#39;userId&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  table<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// create table &#39;users&#39;</span>
<span class="token comment">// with a composite primary key (&#39;userId&#39;, &#39;name&#39;).</span>
<span class="token comment">// increments doesn&#39;t generate primary key.</span>
knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">primary</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;userId&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;name&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  table<span class="token punctuation">.</span><span class="token function">increments</span><span class="token punctuation">(</span><span class="token string">&#39;userId&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  table<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// reference the &#39;users&#39; primary key in new table &#39;posts&#39;</span>
knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token string">&#39;posts&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">integer</span><span class="token punctuation">(</span><span class="token string">&#39;author&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unsigned</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">notNullable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  table<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;title&#39;</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  table<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;content&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  table<span class="token punctuation">.</span><span class="token function">foreign</span><span class="token punctuation">(</span><span class="token string">&#39;author&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">references</span><span class="token punctuation">(</span><span class="token string">&#39;userId&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">inTable</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>A primaryKey option may be passed, to disable to automatic primary key creation:</p><div class="language-js"><pre><code><span class="token comment">// create table &#39;users&#39;</span>
<span class="token comment">// with a primary key using &#39;increments()&#39;</span>
<span class="token comment">// but also increments field &#39;other_id&#39;</span>
<span class="token comment">// that does not need primary key</span>
knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">increments</span><span class="token punctuation">(</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  table<span class="token punctuation">.</span><span class="token function">increments</span><span class="token punctuation">(</span><span class="token string">&#39;other_id&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">primaryKey</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="integer" tabindex="-1">integer <a class="header-anchor" href="#integer" aria-hidden="true">#</a></h3><p><strong>table.integer(name, length)</strong></p><p>Adds an integer column. On PostgreSQL you cannot adjust the length, you need to use other option such as bigInteger, etc</p><h3 id="biginteger" tabindex="-1">bigInteger <a class="header-anchor" href="#biginteger" aria-hidden="true">#</a></h3><p><strong>table.bigInteger(name)</strong></p><p>In MySQL or PostgreSQL, adds a bigint column, otherwise adds a normal integer. Note that bigint data is returned as a string in queries because JavaScript may be unable to parse them without loss of precision.</p><h3 id="tinyint" tabindex="-1">tinyint <a class="header-anchor" href="#tinyint" aria-hidden="true">#</a></h3><p><strong>table.tinyint(name, length)</strong></p><p>Adds a tinyint column</p><h3 id="smallint" tabindex="-1">smallint <a class="header-anchor" href="#smallint" aria-hidden="true">#</a></h3><p><strong>table.smallint(name)</strong></p><p>Adds a smallint column</p><h3 id="mediumint" tabindex="-1">mediumint <a class="header-anchor" href="#mediumint" aria-hidden="true">#</a></h3><p><strong>table.mediumint(name)</strong></p><p>Adds a mediumint column</p><h3 id="bigint" tabindex="-1">bigint <a class="header-anchor" href="#bigint" aria-hidden="true">#</a></h3><p><strong>table.bigint(name)</strong></p><p>Adds a bigint column</p><h3 id="text" tabindex="-1">text <a class="header-anchor" href="#text" aria-hidden="true">#</a></h3><p><strong>table.text(name, [textType])</strong></p><p>Adds a text column, with optional textType for MySql text datatype preference. textType may be mediumtext or longtext, otherwise defaults to text.</p><h3 id="string" tabindex="-1">string <a class="header-anchor" href="#string" aria-hidden="true">#</a></h3><p><strong>table.string(name, [length])</strong></p><p>Adds a string column, with optional length defaulting to 255.</p><h3 id="float" tabindex="-1">float <a class="header-anchor" href="#float" aria-hidden="true">#</a></h3><p><strong>table.float(column, [precision], [scale])</strong></p><p>Adds a float column, with optional precision (defaults to 8) and scale (defaults to 2).</p><h3 id="double" tabindex="-1">double <a class="header-anchor" href="#double" aria-hidden="true">#</a></h3><p><strong>table.double(column, [precision], [scale])</strong></p><p>Adds a double column, with optional precision (defaults to 8) and scale (defaults to 2). In SQLite/MSSQL this is a float with no precision/scale; In PostgreSQL this is a double precision; In Oracle this is a number with matching precision/scale.</p><h3 id="decimal" tabindex="-1">decimal <a class="header-anchor" href="#decimal" aria-hidden="true">#</a></h3><p><strong>table.decimal(column, [precision], [scale])</strong></p><p>Adds a decimal column, with optional precision (defaults to 8) and scale (defaults to 2). Specifying NULL as precision creates a decimal column that can store numbers of any precision and scale. (Only supported for Oracle, SQLite, Postgres)</p><h3 id="boolean" tabindex="-1">boolean <a class="header-anchor" href="#boolean" aria-hidden="true">#</a></h3><p><strong>table.boolean(name)</strong></p><p>Adds a boolean column.</p><h3 id="date" tabindex="-1">date <a class="header-anchor" href="#date" aria-hidden="true">#</a></h3><p><strong>table.date(name)</strong></p><p>Adds a date column.</p><h3 id="datetime" tabindex="-1">datetime <a class="header-anchor" href="#datetime" aria-hidden="true">#</a></h3><p><strong>table.datetime(name, options={[useTz: boolean], [precision: number]})</strong></p><p>Adds a datetime column. By default PostgreSQL creates column with timezone (timestamptz type). This behaviour can be overriden by passing the useTz option (which is by default true for PostgreSQL). MySQL and MSSQL do not have useTz option.</p><p>A precision option may be passed:</p><div class="language-js"><pre><code>table<span class="token punctuation">.</span><span class="token function">datetime</span><span class="token punctuation">(</span><span class="token string">&#39;some_time&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">precision</span><span class="token operator">:</span> <span class="token number">6</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">defaultTo</span><span class="token punctuation">(</span>knex<span class="token punctuation">.</span>fn<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="time" tabindex="-1">time <a class="header-anchor" href="#time" aria-hidden="true">#</a></h3><p><strong>table.time(name, [precision])</strong></p><p>Adds a time column, with optional precision for MySQL. Not supported on Amazon Redshift.</p><p>In MySQL a precision option may be passed:</p><div class="language-js"><pre><code>table<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token string">&#39;some_time&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">precision</span><span class="token operator">:</span> <span class="token number">6</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="timestamp" tabindex="-1">timestamp <a class="header-anchor" href="#timestamp" aria-hidden="true">#</a></h3><p><strong>table.timestamp(name, options={[useTz: boolean], [precision: number]})</strong></p><p>Adds a timestamp column. By default PostgreSQL creates column with timezone (timestamptz type) and MSSQL does not (datetime2). This behaviour can be overriden by passing the useTz option (which is by default false for MSSQL and true for PostgreSQL). MySQL does not have useTz option.</p><div class="language-js"><pre><code>table<span class="token punctuation">.</span><span class="token function">timestamp</span><span class="token punctuation">(</span><span class="token string">&#39;created_at&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">defaultTo</span><span class="token punctuation">(</span>knex<span class="token punctuation">.</span>fn<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>In PostgreSQL and MySQL a precision option may be passed:</p><div class="language-js"><pre><code>table<span class="token punctuation">.</span><span class="token function">timestamp</span><span class="token punctuation">(</span><span class="token string">&#39;created_at&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">precision</span><span class="token operator">:</span> <span class="token number">6</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">defaultTo</span><span class="token punctuation">(</span>knex<span class="token punctuation">.</span>fn<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>In PostgreSQL and MSSQL a timezone option may be passed:</p><div class="language-js"><pre><code>table<span class="token punctuation">.</span><span class="token function">timestamp</span><span class="token punctuation">(</span><span class="token string">&#39;created_at&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">useTz</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="timestamps" tabindex="-1">timestamps <a class="header-anchor" href="#timestamps" aria-hidden="true">#</a></h3><p><strong>table.timestamps([useTimestamps], [defaultToNow], [useCamelCase])</strong></p><p>Adds created_at and updated_at columns on the database, setting each to datetime types. When true is passed as the first argument a timestamp type is used instead. Both columns default to being not null and using the current timestamp when true is passed as the second argument. Note that on MySQL the .timestamps() only have seconds precision, to get better precision use the .datetime or .timestamp methods directly with precision. If useCamelCase is true, the name of columns are createdAt and updatedAt.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>PostgreSQL <code>updated_at</code> field will not automatically be updated. Please see this <a href="https://github.com/knex/knex/issues/1928" title="issue" target="_blank" rel="noopener noreferrer">issue</a> for details</p></div><h3 id="droptimestamps" tabindex="-1">dropTimestamps <a class="header-anchor" href="#droptimestamps" aria-hidden="true">#</a></h3><p><strong>table.dropTimestamps([useCamelCase])</strong></p><p>Drops the columns created_at and updated_at from the table, which can be created via timestamps. If useCamelCase is true, the name of columns are createdAt and updatedAt.</p><h3 id="binary" tabindex="-1">binary <a class="header-anchor" href="#binary" aria-hidden="true">#</a></h3><p><strong>table.binary(name, [length])</strong></p><p>Adds a binary column, with optional length argument for MySQL.</p><h3 id="enum-enu" tabindex="-1">enum / enu <a class="header-anchor" href="#enum-enu" aria-hidden="true">#</a></h3><p><strong>table.enu(col, values, [options])</strong></p><p>Adds a enum column, (aliased to enu, as enum is a reserved word in JavaScript). Implemented as unchecked varchar(255) on Amazon Redshift. Note that the second argument is an array of values. Example:</p><div class="language-js"><pre><code>table<span class="token punctuation">.</span><span class="token function">enu</span><span class="token punctuation">(</span><span class="token string">&#39;column&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;value1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;value2&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>For Postgres, an additional options argument can be provided to specify whether or not to use Postgres&#39;s native TYPE:</p><div class="language-js"><pre><code>table<span class="token punctuation">.</span><span class="token function">enu</span><span class="token punctuation">(</span><span class="token string">&#39;column&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;value1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;value2&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">useNative</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">enumName</span><span class="token operator">:</span> <span class="token string">&#39;foo_type&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>It will use the values provided to generate the appropriate TYPE. Example:</p><div class="language-sql"><pre><code><span class="token keyword">CREATE</span> <span class="token keyword">TYPE</span> <span class="token string">&quot;foo_type&quot;</span> <span class="token keyword">AS</span> <span class="token keyword">ENUM</span> <span class="token punctuation">(</span><span class="token string">&#39;value1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;value2&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>To use an existing native type across columns, specify &#39;existingType&#39; in the options (this assumes the type has already been created):</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Since the enum values aren&#39;t utilized for a native &amp;&amp; existing type, the type being passed in for values is immaterial.</p></div><div class="language-js"><pre><code>table<span class="token punctuation">.</span><span class="token function">enu</span><span class="token punctuation">(</span><span class="token string">&#39;column&#39;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">useNative</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">existingType</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">enumName</span><span class="token operator">:</span> <span class="token string">&#39;foo_type&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>If you want to use existing enums from a schema, different from the schema of your current table, specify &#39;schemaName&#39; in the options:</p><div class="language-js"><pre><code>table<span class="token punctuation">.</span><span class="token function">enu</span><span class="token punctuation">(</span><span class="token string">&#39;column&#39;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">useNative</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">existingType</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">enumName</span><span class="token operator">:</span> <span class="token string">&#39;foo_type&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">schemaName</span><span class="token operator">:</span> <span class="token string">&#39;public&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Knex does not provide any way to alter enumerations after creation. To change an enumeration later on you must use Knex.raw, and the appropriate command for your database.</p><h3 id="json" tabindex="-1">json <a class="header-anchor" href="#json" aria-hidden="true">#</a></h3><p><strong>table.json(name)</strong></p><p>Adds a json column, using the built-in json type in PostgreSQL, MySQL and SQLite, defaulting to a text column in older versions or in unsupported databases.</p><p>For PostgreSQL, due to incompatibility between native array and json types, when setting an array (or a value that could be an array) as the value of a json or jsonb column, you should use JSON.stringify() to convert your value to a string prior to passing it to the query builder, e.g.</p><div class="language-js"><pre><code>knex
  <span class="token punctuation">.</span><span class="token function">table</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">json_data</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>mightBeAnArray<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="jsonb" tabindex="-1">jsonb <a class="header-anchor" href="#jsonb" aria-hidden="true">#</a></h3><p><strong>table.jsonb(name)</strong></p><p>Adds a jsonb column. Works similar to table.json(), but uses native jsonb type if possible.</p><h3 id="uuid" tabindex="-1">uuid <a class="header-anchor" href="#uuid" aria-hidden="true">#</a></h3><p><strong>table.uuid(name, options=({[useBinaryUuid:boolean],[primaryKey:boolean]})</strong></p><p>Adds a uuid column - this uses the built-in uuid type in PostgreSQL, and falling back to a char(36) in other databases by default. If useBinaryUuid is true, binary(16) is used. See uuidToBin function to convert uuid in binary before inserting and binToUuid to convert binary uuid to uuid. If primaryKey is true, then for PostgreSQL the field will be configured as <code>uuid primary key</code>, for CockroackDB an additional <code>default gen_random_uuid()</code> is set on the type.</p><p>You may set the default value to the uuid helper function. Not supported by Redshift.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span>tblName<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">uuid</span><span class="token punctuation">(</span><span class="token string">&#39;uuidColumn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">defaultTo</span><span class="token punctuation">(</span>knex<span class="token punctuation">.</span>fn<span class="token punctuation">.</span><span class="token function">uuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="geometry" tabindex="-1">geometry <a class="header-anchor" href="#geometry" aria-hidden="true">#</a></h3><p><strong>table.geometry(name)</strong></p><p>Adds a geometry column. Supported by SQLite, MSSQL and PostgreSQL.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span>tblName<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">geometry</span><span class="token punctuation">(</span><span class="token string">&#39;geometryColumn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="geography" tabindex="-1">geography <a class="header-anchor" href="#geography" aria-hidden="true">#</a></h3><p><strong>table.geography(name)</strong></p><p>Adds a geography column. Supported by SQLite, MSSQL and PostgreSQL (in PostGIS extension).</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span>tblName<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">geography</span><span class="token punctuation">(</span><span class="token string">&#39;geographyColumn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="point" tabindex="-1">point <a class="header-anchor" href="#point" aria-hidden="true">#</a></h3><p><strong>table.point(name)</strong></p><p>Add a point column. Not supported by CockroachDB and MSSQL.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span>tblName<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">point</span><span class="token punctuation">(</span><span class="token string">&#39;pointColumn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="comment" tabindex="-1">comment <a class="header-anchor" href="#comment" aria-hidden="true">#</a></h3><p><strong>table.comment(value)</strong></p><p>Sets the comment for a table.</p><h3 id="engine" tabindex="-1">engine <a class="header-anchor" href="#engine" aria-hidden="true">#</a></h3><p><strong>table.engine(val)</strong></p><p>Sets the engine for the database table, only available within a createTable call, and only applicable to MySQL.</p><h3 id="charset" tabindex="-1">charset <a class="header-anchor" href="#charset" aria-hidden="true">#</a></h3><p><strong>table.charset(val)</strong></p><p>Sets the charset for the database table, only available within a createTable call, and only applicable to MySQL.</p><h3 id="collate" tabindex="-1">collate <a class="header-anchor" href="#collate" aria-hidden="true">#</a></h3><p><strong>table.collate(val)</strong></p><p>Sets the collation for the database table, only available within a createTable call, and only applicable to MySQL.</p><h3 id="inherits" tabindex="-1">inherits <a class="header-anchor" href="#inherits" aria-hidden="true">#</a></h3><p><strong>table.inherits(val)</strong></p><p>Sets the tables that this table inherits, only available within a createTable call, and only applicable to PostgreSQL.</p><h3 id="specifictype" tabindex="-1">specificType <a class="header-anchor" href="#specifictype" aria-hidden="true">#</a></h3><p><strong>table.specificType(name, type)</strong></p><p>Sets a specific type for the column creation, if you&#39;d like to add a column type that isn&#39;t supported here.</p><h3 id="index" tabindex="-1">index <a class="header-anchor" href="#index" aria-hidden="true">#</a></h3><p><strong>table.index(columns, [indexName], options=({[indexType: string], [storageEngineIndexType: &#39;btree&#39;|&#39;hash&#39;], [predicate: QueryBuilder]}))</strong></p><p>Adds an index to a table over the given columns. A default index name using the columns is used unless indexName is specified. In MySQL, the storage engine index type may be &#39;btree&#39; or &#39;hash&#39; index types, more info in Index Options section : <a href="https://dev.mysql.com/doc/refman/8.0/en/create-index.html" target="_blank" rel="noopener noreferrer">https://dev.mysql.com/doc/refman/8.0/en/create-index.html</a>. The indexType can be optionally specified for PostgreSQL and MySQL. Amazon Redshift does not allow creating an index. In PostgreSQL, SQLite and MSSQL a partial index can be specified by setting a &#39;where&#39; predicate.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span><span class="token function">table</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;last_name&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&#39;idx_name_last_name&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">indexType</span><span class="token operator">:</span> <span class="token string">&#39;FULLTEXT&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">storageEngineIndexType</span><span class="token operator">:</span> <span class="token string">&#39;hash&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">predicate</span><span class="token operator">:</span> knex<span class="token punctuation">.</span><span class="token function">whereNotNull</span><span class="token punctuation">(</span><span class="token string">&#39;email&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="dropindex" tabindex="-1">dropIndex <a class="header-anchor" href="#dropindex" aria-hidden="true">#</a></h3><p><strong>table.dropIndex(columns, [indexName])</strong></p><p>Drops an index from a table. A default index name using the columns is used unless indexName is specified (in which case columns is ignored). Amazon Redshift does not allow creating an index.</p><h3 id="setnullable" tabindex="-1">setNullable <a class="header-anchor" href="#setnullable" aria-hidden="true">#</a></h3><p><strong>table.setNullable(column)</strong></p><p>Makes table column nullable.</p><h3 id="dropnullable" tabindex="-1">dropNullable <a class="header-anchor" href="#dropnullable" aria-hidden="true">#</a></h3><p><strong>table.dropNullable(column)</strong></p><p>Makes table column not nullable. Note that this operation will fail if there are already null values in this column.</p><h3 id="primary" tabindex="-1">primary <a class="header-anchor" href="#primary" aria-hidden="true">#</a></h3><p><strong>table.primary(columns, options=({[constraintName:string],[deferrable:&#39;not deferrable&#39;|&#39;deferred&#39;|&#39;immediate&#39;]})</strong></p><p>Create a primary key constraint on table using input <code>columns</code>. If you need to create a composite primary key, pass an array of columns to <code>columns</code>. Constraint name defaults to <code>tablename_pkey</code> unless <code>constraintName</code> is specified. On Amazon Redshift, all columns included in a primary key must be not nullable. Deferrable primary constraint are supported on Postgres and Oracle and can be set by passing deferrable option to options object.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">alterTable</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">t</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  t<span class="token punctuation">.</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token string">&#39;email&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">alterTable</span><span class="token punctuation">(</span><span class="token string">&#39;job&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">t</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  t<span class="token punctuation">.</span><span class="token function">primary</span><span class="token punctuation">(</span><span class="token string">&#39;email&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">constraintName</span><span class="token operator">:</span> <span class="token string">&#39;users_primary_key&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">deferrable</span><span class="token operator">:</span> <span class="token string">&#39;deferred&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>If you want to chain primary() while creating new column you can use <a href="#primary-1">primary</a></p></div><h3 id="unique" tabindex="-1">unique <a class="header-anchor" href="#unique" aria-hidden="true">#</a></h3><p><strong>table.unique(columns, options={[indexName: string], [deferrable:&#39;not deferrable&#39;|&#39;immediate&#39;|&#39;deferred&#39;], [storageEngineIndexType:&#39;btree&#39;|&#39;hash&#39;], [useConstraint:true|false], [predicate: QueryBuilder]})</strong></p><p>Adds an unique index to a table over the given <code>columns</code>. In MySQL, the storage engine index type may be &#39;btree&#39; or &#39;hash&#39; index types, more info in Index Options section : <a href="https://dev.mysql.com/doc/refman/8.0/en/create-index.html" target="_blank" rel="noopener noreferrer">https://dev.mysql.com/doc/refman/8.0/en/create-index.html</a>. A default index name using the columns is used unless indexName is specified. If you need to create a composite index, pass an array of column to <code>columns</code>. Deferrable unique constraint are supported on Postgres and Oracle and can be set by passing deferrable option to options object. In MSSQL and Postgres, you can set the <code>useConstraint</code> option to true to create a unique constraint instead of a unique index (defaults to false for MSSQL, true for Postgres without <code>predicate</code>, false for Postgres with <code>predicate</code>). In PostgreSQL, SQLite and MSSQL a partial unique index can be specified by setting a &#39;where&#39; predicate.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">alterTable</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">t</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  t<span class="token punctuation">.</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token string">&#39;email&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">alterTable</span><span class="token punctuation">(</span><span class="token string">&#39;job&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">t</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  t<span class="token punctuation">.</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;account_id&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;program_id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">indexName</span><span class="token operator">:</span> <span class="token string">&#39;job_composite_index&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">deferrable</span><span class="token operator">:</span> <span class="token string">&#39;deferred&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">storageEngineIndexType</span><span class="token operator">:</span> <span class="token string">&#39;hash&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">alterTable</span><span class="token punctuation">(</span><span class="token string">&#39;job&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">t</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  t<span class="token punctuation">.</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;account_id&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;program_id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">indexName</span><span class="token operator">:</span> <span class="token string">&#39;job_composite_index&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">useConstraint</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">alterTable</span><span class="token punctuation">(</span><span class="token string">&#39;job&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">t</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  t<span class="token punctuation">.</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;account_id&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;program_id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">indexName</span><span class="token operator">:</span> <span class="token string">&#39;job_composite_index&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">predicate</span><span class="token operator">:</span> knex<span class="token punctuation">.</span><span class="token function">whereNotNull</span><span class="token punctuation">(</span><span class="token string">&#39;account_id&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>If you want to chain unique() while creating new column you can use <a href="#unique-1">unique</a></p></div><h3 id="foreign" tabindex="-1">foreign <a class="header-anchor" href="#foreign" aria-hidden="true">#</a></h3><p><strong>table.foreign(columns, [foreignKeyName])[.onDelete(statement).onUpdate(statement).withKeyName(foreignKeyName).deferrable(type)]</strong></p><p>Adds a foreign key constraint to a table for an existing column using <code>table.foreign(column).references(column)</code> or multiple columns using <code>table.foreign(columns).references(columns).inTable(table)</code>.</p><p>A default key name using the columns is used unless <code>foreignKeyName</code> is specified.</p><p>You can also chain <code>onDelete()</code> and/or <code>onUpdate()</code> to set the reference option <code>(RESTRICT, CASCADE, SET NULL, NO ACTION)</code> for the operation. You can also chain <code>withKeyName()</code> to override default key name that is generated from table and column names (result is identical to specifying second parameter to function <code>foreign()</code>).</p><p>Deferrable foreign constraint is supported on Postgres and Oracle and can be set by chaining <code>.deferrable(type)</code></p><p>Note that using <code>foreign()</code> is the same as <code>column.references(column)</code> but it works for existing columns.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">table</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">integer</span><span class="token punctuation">(</span><span class="token string">&#39;user_id&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unsigned</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  table
    <span class="token punctuation">.</span><span class="token function">foreign</span><span class="token punctuation">(</span><span class="token string">&#39;user_id&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">references</span><span class="token punctuation">(</span><span class="token string">&#39;Items.user_id_in_items&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">deferrable</span><span class="token punctuation">(</span><span class="token string">&#39;deferred&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="dropforeign" tabindex="-1">dropForeign <a class="header-anchor" href="#dropforeign" aria-hidden="true">#</a></h3><p><strong>table.dropForeign(columns, [foreignKeyName])</strong></p><p>Drops a foreign key constraint from a table. A default foreign key name using the columns is used unless foreignKeyName is specified (in which case columns is ignored).</p><h3 id="dropunique" tabindex="-1">dropUnique <a class="header-anchor" href="#dropunique" aria-hidden="true">#</a></h3><p><strong>table.dropUnique(columns, [indexName])</strong></p><p>Drops a unique key constraint from a table. A default unique key name using the columns is used unless indexName is specified (in which case columns is ignored).</p><h3 id="dropprimary" tabindex="-1">dropPrimary <a class="header-anchor" href="#dropprimary" aria-hidden="true">#</a></h3><p><strong>table.dropPrimary([constraintName])</strong></p><p>Drops the primary key constraint on a table. Defaults to tablename_pkey unless constraintName is specified.</p><h3 id="querycontext-1" tabindex="-1">queryContext <a class="header-anchor" href="#querycontext-1" aria-hidden="true">#</a></h3><p><strong>table.queryContext(context)</strong></p><p>Allows configuring a context to be passed to the <a href="/guide/#wrapidentifier">wrapIdentifier</a> hook for formatting table builder identifiers. The context can be any kind of value and will be passed to <code>wrapIdentifier</code> without modification.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">table</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">queryContext</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token string">&#39;bar&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  table<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;first_name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  table<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;last_name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This method also enables overwriting the context configured for a schema builder instance via <a href="/guide/schema-builder.html#querycontext">schema.queryContext</a>:</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">queryContext</span><span class="token punctuation">(</span><span class="token string">&#39;schema context&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">table</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">queryContext</span><span class="token punctuation">(</span><span class="token string">&#39;table context&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  table<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;first_name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  table<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;last_name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Note that it&#39;s also possible to overwrite the table builder context for any column in the table definition:</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">queryContext</span><span class="token punctuation">(</span><span class="token string">&#39;schema context&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">table</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">queryContext</span><span class="token punctuation">(</span><span class="token string">&#39;table context&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  table<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;first_name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">queryContext</span><span class="token punctuation">(</span><span class="token string">&#39;first_name context&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  table<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;last_name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">queryContext</span><span class="token punctuation">(</span><span class="token string">&#39;last_name context&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Calling <code>queryContext</code> with no arguments will return any context configured for the table builder instance.</p><h2 id="chainable-methods" tabindex="-1">Chainable Methods <a class="header-anchor" href="#chainable-methods" aria-hidden="true">#</a></h2><p>The following three methods may be chained on the schema building methods, as modifiers to the column.</p><h3 id="alter" tabindex="-1">alter <a class="header-anchor" href="#alter" aria-hidden="true">#</a></h3><p><strong>column.alter(options={[alterNullable: boolean = true, alterType: boolean = true])</strong></p><p>Marks the column as an alter / modify, instead of the default add.</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>This only works in .alterTable() and is not supported by SQlite or Amazon Redshift. Alter is <em>not</em> done incrementally over older column type so if you like to add <code>notNullable</code> and keep the old default value, the alter statement must contain both <code>.notNullable().defaultTo(1).alter()</code>. If one just tries to add <code>.notNullable().alter()</code> the old default value will be dropped. Nullable alterations are done only if alterNullable is true. Type alterations are done only if alterType is true.</p></div><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">alterTable</span><span class="token punctuation">(</span><span class="token string">&#39;user&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">t</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  t<span class="token punctuation">.</span><span class="token function">increments</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">primary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// add</span>
  <span class="token comment">// drops previous default value from column,</span>
  <span class="token comment">// change type to string and add not nullable constraint</span>
  t<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;username&#39;</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">notNullable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">alter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// drops both not null constraint and the default value</span>
  t<span class="token punctuation">.</span><span class="token function">integer</span><span class="token punctuation">(</span><span class="token string">&#39;age&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">alter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// if alterNullable is false, drops only the default value</span>
  t<span class="token punctuation">.</span><span class="token function">integer</span><span class="token punctuation">(</span><span class="token string">&#39;age&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">alter</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">alterNullable</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// if alterType is false, type of column is not altered.</span>
  t<span class="token punctuation">.</span><span class="token function">integer</span><span class="token punctuation">(</span><span class="token string">&#39;age&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">alter</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">alterType</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="index-1" tabindex="-1">index <a class="header-anchor" href="#index-1" aria-hidden="true">#</a></h3><p><strong>column.index([indexName], options=({[indexType: string], [storageEngineIndexType: &#39;btree&#39;|&#39;hash&#39;], [predicate: QueryBuilder]}))</strong></p><p>Specifies a field as an index. If an indexName is specified, it is used in place of the standard index naming convention of tableName_columnName. In MySQL, the storage engine index type may be &#39;btree&#39; or &#39;hash&#39; index types, more info in Index Options section : <a href="https://dev.mysql.com/doc/refman/8.0/en/create-index.html" target="_blank" rel="noopener noreferrer">https://dev.mysql.com/doc/refman/8.0/en/create-index.html</a>. The indexType can be optionally specified for PostgreSQL and MySQL. No-op if this is chained off of a field that cannot be indexed. In PostgreSQL, SQLite and MSSQL a partial index can be specified by setting a &#39;where&#39; predicate.</p><h3 id="primary-1" tabindex="-1">primary <a class="header-anchor" href="#primary-1" aria-hidden="true">#</a></h3><p><strong>column.primary(options=({[constraintName:string],[deferrable:&#39;not deferrable&#39;|&#39;deferred&#39;|&#39;immediate&#39;]}));</strong></p><p>Sets a primary key constraint on <code>column</code>. Constraint name defaults to <code>tablename_pkey</code> unless <code>constraintName</code> is specified. On Amazon Redshift, all columns included in a primary key must be not nullable. Deferrable primary constraint are supported on Postgres and Oracle and can be set by passing deferrable option to options object.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">table</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">integer</span><span class="token punctuation">(</span><span class="token string">&#39;user_id&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">primary</span><span class="token punctuation">(</span><span class="token string">&#39;email&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">constraintName</span><span class="token operator">:</span> <span class="token string">&#39;users_primary_key&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">deferrable</span><span class="token operator">:</span> <span class="token string">&#39;deferred&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>If you want to create primary constraint on existing column use <a href="#primary">primary</a></p></div><h3 id="unique-1" tabindex="-1">unique <a class="header-anchor" href="#unique-1" aria-hidden="true">#</a></h3><p><strong>column.unique(options={[indexName:string],[deferrable:&#39;not deferrable&#39;|&#39;immediate&#39;|&#39;deferred&#39;]})</strong></p><p>Sets the <code>column</code> as unique. On Amazon Redshift, this constraint is not enforced, but it is used by the query planner. Deferrable unique constraint are supported on Postgres and Oracle and can be set by passing deferrable option to options object.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">table</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  table
    <span class="token punctuation">.</span><span class="token function">integer</span><span class="token punctuation">(</span><span class="token string">&#39;user_id&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">indexName</span><span class="token operator">:</span> <span class="token string">&#39;user_unique_id&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">deferrable</span><span class="token operator">:</span> <span class="token string">&#39;immediate&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>If you want to create unique constraint on existing column use <a href="#unique">unique</a></p></div><h3 id="references" tabindex="-1">references <a class="header-anchor" href="#references" aria-hidden="true">#</a></h3><p><strong>column.references(column)</strong></p><p>Sets the &quot;column&quot; that the current column references as a foreign key. &quot;column&quot; can either be &quot;.&quot; syntax, or just the column name followed up with a call to inTable to specify the table.</p><h3 id="intable" tabindex="-1">inTable <a class="header-anchor" href="#intable" aria-hidden="true">#</a></h3><p><strong>column.inTable(table)</strong></p><p>Sets the &quot;table&quot; where the foreign key column is located after calling column.references.</p><h3 id="ondelete" tabindex="-1">onDelete <a class="header-anchor" href="#ondelete" aria-hidden="true">#</a></h3><p><strong>column.onDelete(command)</strong></p><p>Sets the SQL command to be run &quot;onDelete&quot;.</p><h3 id="onupdate" tabindex="-1">onUpdate <a class="header-anchor" href="#onupdate" aria-hidden="true">#</a></h3><p><strong>column.onUpdate(command)</strong></p><p>Sets the SQL command to be run &quot;onUpdate&quot;.</p><h3 id="defaultto" tabindex="-1">defaultTo <a class="header-anchor" href="#defaultto" aria-hidden="true">#</a></h3><p><strong>column.defaultTo(value, options={[constraintName: string = undefined]))</strong></p><p>Sets the default value for the column on an insert.</p><p>In MSSQL a constraintName option may be passed to ensure a specific constraint name:</p><div class="language-js"><pre><code>column<span class="token punctuation">.</span><span class="token function">defaultTo</span><span class="token punctuation">(</span><span class="token string">&#39;value&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">constraintName</span><span class="token operator">:</span> <span class="token string">&#39;df_table_value&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="unsigned" tabindex="-1">unsigned <a class="header-anchor" href="#unsigned" aria-hidden="true">#</a></h3><p><strong>column.unsigned()</strong></p><p>Specifies a number as unsigned. Only for numeric values.</p><h3 id="notnullable" tabindex="-1">notNullable <a class="header-anchor" href="#notnullable" aria-hidden="true">#</a></h3><p><strong>column.notNullable()</strong></p><p>Adds a not null on the current column being created.</p><h3 id="nullable" tabindex="-1">nullable <a class="header-anchor" href="#nullable" aria-hidden="true">#</a></h3><p><strong>column.nullable()</strong></p><p>Default on column creation, this explicitly sets a field to be nullable.</p><h3 id="first" tabindex="-1">first <a class="header-anchor" href="#first" aria-hidden="true">#</a></h3><p><strong>column.first()</strong></p><p>Sets the column to be inserted on the first position, only used in MySQL alter tables.</p><h3 id="after" tabindex="-1">after <a class="header-anchor" href="#after" aria-hidden="true">#</a></h3><p><strong>column.after(field)</strong></p><p>Sets the column to be inserted after another, only used in MySQL alter tables.</p><h3 id="comment-1" tabindex="-1">comment <a class="header-anchor" href="#comment-1" aria-hidden="true">#</a></h3><p><strong>column.comment(value)</strong></p><p>Sets the comment for a column.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token string">&#39;accounts&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">t</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  t<span class="token punctuation">.</span><span class="token function">increments</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">primary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  t<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;email&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">comment</span><span class="token punctuation">(</span><span class="token string">&#39;This is the email field&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="collate-1" tabindex="-1">collate <a class="header-anchor" href="#collate-1" aria-hidden="true">#</a></h3><p><strong>column.collate(collation)</strong></p><p>Sets the collation for a column (only works in MySQL). Here is a list of all available collations: <a href="https://dev.mysql.com/doc/refman/5.5/en/charset-charsets.html" target="_blank" rel="noopener noreferrer">https://dev.mysql.com/doc/refman/5.5/en/charset-charsets.html</a></p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">t</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  t<span class="token punctuation">.</span><span class="token function">increments</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  t<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;email&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collate</span><span class="token punctuation">(</span><span class="token string">&#39;utf8_unicode_ci&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="view" tabindex="-1">View <a class="header-anchor" href="#view" aria-hidden="true">#</a></h2><h3 id="columns" tabindex="-1">columns <a class="header-anchor" href="#columns" aria-hidden="true">#</a></h3><p><strong>view.columns([columnNames])</strong></p><p>Specify the columns of the view.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createView</span><span class="token punctuation">(</span><span class="token string">&#39;users_view&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">view</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  view<span class="token punctuation">.</span><span class="token function">columns</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;first_name&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;last_name&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  view<span class="token punctuation">.</span><span class="token function">as</span><span class="token punctuation">(</span><span class="token function">knex</span><span class="token punctuation">(</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&#39;first_name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">&#39;age&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;&gt;&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;18&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="as" tabindex="-1">as <a class="header-anchor" href="#as" aria-hidden="true">#</a></h3><p><strong><a href="http://view.as" target="_blank" rel="noopener noreferrer">view.as</a>(selectQuery)</strong></p><p>Specify the select query of the view.</p><h3 id="checkoption" tabindex="-1">checkOption <a class="header-anchor" href="#checkoption" aria-hidden="true">#</a></h3><p><strong>view.checkOption()</strong></p><p>Add check option on the view definition. On OracleDb, MySQL, PostgreSQL and Redshift.</p><h3 id="localcheckoption" tabindex="-1">localCheckOption <a class="header-anchor" href="#localcheckoption" aria-hidden="true">#</a></h3><p><strong>view.localCheckOption()</strong></p><p>Add local check option on the view definition. On MySQL, PostgreSQL and Redshift.</p><h3 id="cascadedcheckoption" tabindex="-1">cascadedCheckOption <a class="header-anchor" href="#cascadedcheckoption" aria-hidden="true">#</a></h3><p><strong>view.cascadedCheckOption()</strong></p><p>Add cascaded check option on the view definition. On MySQL, PostgreSQL and Redshift.</p><h2 id="checks" tabindex="-1">Checks <a class="header-anchor" href="#checks" aria-hidden="true">#</a></h2><h3 id="check" tabindex="-1">check <a class="header-anchor" href="#check" aria-hidden="true">#</a></h3><p><strong>table.check(checkPredicate, [bindings], [constraintName]))</strong></p><p>Specify a check on table or column with raw predicate.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token string">&#39;product&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">integer</span><span class="token punctuation">(</span><span class="token string">&#39;price_min&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  table<span class="token punctuation">.</span><span class="token function">integer</span><span class="token punctuation">(</span><span class="token string">&#39;price&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  table<span class="token punctuation">.</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token string">&#39;?? &gt;= ??&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;price&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;price_min&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="checkpositive" tabindex="-1">checkPositive <a class="header-anchor" href="#checkpositive" aria-hidden="true">#</a></h3><p><strong>column.checkPositive([constraintName])</strong></p><p>Specify a check on column that test if the value of column is positive.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token string">&#39;product&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">integer</span><span class="token punctuation">(</span><span class="token string">&#39;price&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">checkPositive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="checknegative" tabindex="-1">checkNegative <a class="header-anchor" href="#checknegative" aria-hidden="true">#</a></h3><p><strong>column.checkNegative([constraintName])</strong></p><p>Specify a check on column that test if the value of column is negative.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token string">&#39;product&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">integer</span><span class="token punctuation">(</span><span class="token string">&#39;price_decrease&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">checkNegative</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="checkin" tabindex="-1">checkIn <a class="header-anchor" href="#checkin" aria-hidden="true">#</a></h3><p><strong>column.checkIn(values, [constraintName])</strong></p><p>Specify a check on column that test if the value of column is contained in a set of specified values.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token string">&#39;product&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;type&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">checkIn</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;table&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;chair&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;sofa&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="checknotin" tabindex="-1">checkNotIn <a class="header-anchor" href="#checknotin" aria-hidden="true">#</a></h3><p><strong>column.checkNotIn(values, [constraintName])</strong></p><p>Specify a check on column that test if the value of column is not contains in a set of specified values.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token string">&#39;product&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;type&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">checkNotIn</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;boot&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;shoe&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="checkbetween" tabindex="-1">checkBetween <a class="header-anchor" href="#checkbetween" aria-hidden="true">#</a></h3><p><strong>column.checkBetween(values, [constraintName])</strong></p><p>Specify a check on column that test if the value of column is within a range of values.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token string">&#39;product&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">integer</span><span class="token punctuation">(</span><span class="token string">&#39;price&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">checkBetween</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// You can add checks on multiple intervals</span>
knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token string">&#39;product&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">integer</span><span class="token punctuation">(</span><span class="token string">&#39;price&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">checkBetween</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="checklength" tabindex="-1">checkLength <a class="header-anchor" href="#checklength" aria-hidden="true">#</a></h3><p><strong>column.checkLength(operator, length, [constraintName])</strong></p><p>Specify a check on column that test if the length of a string match the predicate.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token string">&#39;product&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// operator can be =, !=, &lt;=, &gt;=, &lt;, &gt;</span>
  t<span class="token punctuation">.</span><span class="token function">varchar</span><span class="token punctuation">(</span><span class="token string">&#39;phone&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">checkLength</span><span class="token punctuation">(</span><span class="token string">&#39;=&#39;</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="checkregex" tabindex="-1">checkRegex <a class="header-anchor" href="#checkregex" aria-hidden="true">#</a></h3><p><strong>column.checkRegex(regex, [constraintName])</strong></p><p>Specify a check on column that test if the value match the specified regular expression. In MSSQL only simple pattern matching in supported but not regex syntax.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token string">&#39;product&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;phone&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">checkRegex</span><span class="token punctuation">(</span><span class="token string">&#39;[0-9]{8}&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// In MSSQL, {8} syntax don&#39;t work,</span>
  <span class="token comment">// you need to duplicate [0-9].</span>
  table<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&#39;phone&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">checkRegex</span><span class="token punctuation">(</span><span class="token string">&#39;[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="dropchecks" tabindex="-1">dropChecks <a class="header-anchor" href="#dropchecks" aria-hidden="true">#</a></h3><p><strong>table.dropChecks([checkConstraintNames])</strong></p><p>Drop checks constraint given an array of constraint names.</p><div class="language-js"><pre><code>knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token string">&#39;product&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  table<span class="token punctuation">.</span><span class="token function">integer</span><span class="token punctuation">(</span><span class="token string">&#39;price&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">checkPositive</span><span class="token punctuation">(</span><span class="token string">&#39;price_check&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  table
    <span class="token punctuation">.</span><span class="token function">integer</span><span class="token punctuation">(</span><span class="token string">&#39;price_proportion&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">checkBetween</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&#39;price_proportion_check&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  table<span class="token punctuation">.</span><span class="token function">dropChecks</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;price_check&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;price_proportion_check&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div></div><footer class="page-footer" data-v-7eddb2c4 data-v-07c132fc><div class="edit" data-v-07c132fc><div class="edit-link" data-v-07c132fc data-v-1ed99556><a class="link" href="https://github.com/knex/knex/edit/master/docs/src/guide/schema-builder.md" target="_blank" rel="noopener noreferrer" data-v-1ed99556>Edit this page on GitHub <svg class="icon outbound icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-1ed99556><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><div class="updated" data-v-07c132fc><!----></div></footer><div class="next-and-prev-link" data-v-7eddb2c4 data-v-38ede35f><div class="container" data-v-38ede35f><div class="prev" data-v-38ede35f><a class="link" href="/guide/transactions" data-v-38ede35f><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-prev" data-v-38ede35f><path d="M19,11H7.4l5.3-5.3c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0l-7,7c-0.1,0.1-0.2,0.2-0.2,0.3c-0.1,0.2-0.1,0.5,0,0.8c0.1,0.1,0.1,0.2,0.2,0.3l7,7c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4L7.4,13H19c0.6,0,1-0.4,1-1S19.6,11,19,11z"></path></svg><span class="text" data-v-38ede35f>Transactions</span></a></div><div class="next" data-v-38ede35f><a class="link" href="/guide/raw" data-v-38ede35f><span class="text" data-v-38ede35f>Raw</span><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-next" data-v-38ede35f><path d="M19.9,12.4c0.1-0.2,0.1-0.5,0-0.8c-0.1-0.1-0.1-0.2-0.2-0.3l-7-7c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l5.3,5.3H5c-0.6,0-1,0.4-1,1s0.4,1,1,1h11.6l-5.3,5.3c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3l7-7C19.8,12.6,19.9,12.5,19.9,12.4z"></path></svg></a></div></div></div><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"changelog.md\":\"17672f85\",\"faq_index.md\":\"5b931eb6\",\"faq_recipes.md\":\"9519710b\",\"faq_support.md\":\"3a1bb589\",\"guide_extending.md\":\"fba00f2b\",\"guide_index.md\":\"8af088ee\",\"guide_interfaces.md\":\"69039f37\",\"guide_migrations.md\":\"a3b60bcd\",\"guide_query-builder.md\":\"bcead624\",\"guide_raw.md\":\"82150b7b\",\"guide_ref.md\":\"871a08f0\",\"guide_schema-builder.md\":\"8594d7f3\",\"guide_transactions.md\":\"287f817f\",\"guide_utility.md\":\"36a2823b\",\"index.md\":\"09ca53f9\"}")</script>
    <script type="module" async src="/assets/app.36cb52e5.js"></script>
    
  </body>
</html>